BEGIN;
ALTER TABLE blue_hydra_devices RENAME TO tmp_devices;
CREATE TABLE blue_hydra_devices (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, uuid VARCHAR(50), name VARCHAR(50), status VARCHAR(50), address VARCHAR(50), uap_lap VARCHAR(50), vendor TEXT, appearance VARCHAR(50), company VARCHAR(50), company_type VARCHAR(50), lmp_version VARCHAR(50), manufacturer VARCHAR(50), firmware VARCHAR(50), classic_mode BOOLEAN DEFAULT 'f', classic_service_uuids TEXT, classic_channels TEXT, classic_major_class VARCHAR(50), classic_minor_class VARCHAR(50), classic_class TEXT, classic_rssi TEXT, classic_tx_power TEXT, classic_features TEXT, classic_features_bitmap TEXT, le_mode BOOLEAN DEFAULT 'f', le_service_uuids TEXT, le_address_type VARCHAR(50), le_random_address_type VARCHAR(50), le_company_data VARCHAR(50), le_company_uuid VARCHAR(50), le_proximity_uuid VARCHAR(50), le_major_num VARCHAR(50), le_minor_num VARCHAR(50), le_flags TEXT, le_rssi TEXT, le_tx_power TEXT, le_features TEXT, le_features_bitmap TEXT, ibeacon_range VARCHAR(50), created_at TIMESTAMP, updated_at TIMESTAMP, last_seen INTEGER);

INSERT INTO "blue_hydra_devices" (
  id,
  uuid,
  name,
  status,
  address,
  uap_lap,
  vendor,
  appearance,
  company,
  company_type,
  lmp_version,
  manufacturer,
  firmware,
  classic_mode,
  classic_service_uuids,
  classic_channels,
  classic_major_class,
  classic_minor_class,
  classic_class,
  classic_rssi,
  classic_tx_power,
  classic_features,
  classic_features_bitmap,
  le_mode,
  le_service_uuids,
  le_address_type,
  le_random_address_type,
  le_company_data,
  le_company_uuid,
  le_proximity_uuid,
  le_major_num,
  le_minor_num,
  le_flags,
  le_rssi,
  le_tx_power,
  le_features,
  le_features_bitmap,
  ibeacon_range,
  created_at,
  updated_at,
  last_seen
) SELECT
  id,
  uuid,
  name,
  status,
  address,
  uap_lap,
  vendor,
  appearance,
  company,
  company_type,
  lmp_version,
  manufacturer,
  firmware,
  classic_mode,
  classic_service_uuids,
  classic_channels,
  classic_major_class,
  classic_minor_class,
  classic_class,
  classic_rssi,
  classic_tx_power,
  classic_features,
  classic_features_bitmap,
  le_mode,
  le_service_uuids,
  le_address_type,
  le_random_address_type,
  le_company_data,
  le_company_uuid,
  le_proximity_uuid,
  le_major_num,
  le_minor_num,
  le_flags,
  le_rssi,
  le_tx_power,
  le_features,
  le_features_bitmap,
  ibeacon_range,
  created_at,
  updated_at,
  last_seen
FROM tmp_devices;

DROP TABLE tmp_devices;
END;
